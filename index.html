<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Dab Timer Pro</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      background-color: #121212;
      color: #ffffff;
    }
    .container {
      max-width: 400px;
      margin: 0 auto;
      background-color: #1e1e1e;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.5);
    }
    h1 {
      color: #4CAF50;
      margin-bottom: 20px;
    }
    .timer-display {
      font-size: 48px;
      margin: 20px 0;
      color: #4CAF50;
      font-weight: bold;
    }
    .button-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
    }
    button {
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background-color: #333;
      color: white;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #4CAF50;
    }
    button:active {
      background-color: #367c39;
    }
    select, input {
      padding: 10px;
      margin: 5px;
      border-radius: 8px;
      background-color: #333;
      color: white;
      border: 1px solid #444;
    }
    .section {
      margin: 15px 0;
      padding: 10px;
      border-radius: 8px;
      background-color: #252525;
    }
    .active {
      background-color: #4CAF50;
    }
    .stop-btn {
      background-color: #f44336;
    }
    .stop-btn:hover {
      background-color: #da190b;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Dab Timer Pro</h1>
    
    <div class="section">
      <label for="material">Nail Material:</label>
      <select id="material">
        <option value="quartz">Quartz (1mm)</option>
        <option value="titanium">Titanium (1mm)</option>
        <option value="ceramic">Ceramic (1mm)</option>
      </select>
    </div>
    
    <div class="section">
      <label for="concentrate">Concentrate Type:</label>
      <select id="concentrate">
        <option value="live_resin">Live Resin/Rosin</option>
        <option value="shatter">Shatter</option>
        <option value="wax">Wax/Budder</option>
        <option value="distillate">Distillate</option>
        <option value="bho">BHO</option>
      </select>
    </div>
    
    <div class="timer-display" id="timer">00:00</div>
    
    <div class="button-group">
      <button id="heat-btn">Start Heating</button>
      <button id="cool-btn">Start Cooling</button>
    </div>
    
    <div>
      <button id="stop" class="stop-btn">Stop Timer</button>
    </div>
  </div>

  <script>
    const { ipcRenderer } = require('electron');
    
    let timerInterval = null;
    let currentMode = null; // 'heating' or 'cooling'
    let timeRemaining = 0;
    
    // Precise timing data based on research and experience
    const timingData = {
      quartz: {
        live_resin: { heat: 25, cool: 60 },
        shatter: { heat: 30, cool: 45 },
        wax: { heat: 28, cool: 50 },
        distillate: { heat: 35, cool: 35 },
        bho: { heat: 32, cool: 42 }
      },
      titanium: {
        live_resin: { heat: 20, cool: 70 },
        shatter: { heat: 25, cool: 55 },
        wax: { heat: 23, cool: 60 },
        distillate: { heat: 30, cool: 45 },
        bho: { heat: 27, cool: 50 }
      },
      ceramic: {
        live_resin: { heat: 22, cool: 55 },
        shatter: { heat: 27, cool: 40 },
        wax: { heat: 25, cool: 45 },
        distillate: { heat: 32, cool: 38 },
        bho: { heat: 29, cool: 43 }
      }
    };
    
    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }
    
    function startHeating() {
      const material = document.getElementById('material').value;
      const concentrate = document.getElementById('concentrate').value;
      const heatTime = timingData[material][concentrate].heat;
      
      timeRemaining = heatTime;
      currentMode = 'heating';
      
      document.getElementById('timer').textContent = formatTime(timeRemaining);
      document.getElementById('heat-btn').classList.add('active');
      document.getElementById('cool-btn').classList.remove('active');
      
      ipcRenderer.send('start-timer', timeRemaining);
    }
    
    function startCooling() {
      const material = document.getElementById('material').value;
      const concentrate = document.getElementById('concentrate').value;
      const coolTime = timingData[material][concentrate].cool;
      
      timeRemaining = coolTime;
      currentMode = 'cooling';
      
      document.getElementById('timer').textContent = formatTime(timeRemaining);
      document.getElementById('cool-btn').classList.add('active');
      document.getElementById('heat-btn').classList.remove('active');
      
      ipcRenderer.send('start-timer', timeRemaining);
    }
    
    function stopTimer() {
      ipcRenderer.send('stop-timer');
      document.getElementById('timer').textContent = '00:00';
      document.getElementById('heat-btn').classList.remove('active');
      document.getElementById('cool-btn').classList.remove('active');
      currentMode = null;
    }
    
    ipcRenderer.on('timer-update', (event, timeRemaining) => {
      document.getElementById('timer').textContent = formatTime(timeRemaining);
    });
    
    ipcRenderer.on('timer-end', () => {
      document.getElementById('timer').textContent = '00:00';
      document.getElementById('heat-btn').classList.remove('active');
      document.getElementById('cool-btn').classList.remove('active');
      
      if (currentMode === 'heating') {
        // Auto-start cooling after heating completes
        startCooling();
      } else {
        alert('Dab ready! Enjoy!');
      }
      
      currentMode = null;
    });
    
    document.getElementById('heat-btn').addEventListener('click', startHeating);
    document.getElementById('cool-btn').addEventListener('click', startCooling);
    document.getElementById('stop').addEventListener('click', stopTimer);
  </script>
</body>
</html>
